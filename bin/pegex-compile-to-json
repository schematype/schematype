#!/usr/bin/env perl

use strict;
use warnings;
use FindBin;
use lib "$FindBin::Bin/../lib/perl5";
use Pegex::Compiler;

my $input = do { local $/; <> };
my $compiler = Pegex::Compiler->new;

$compiler->parse($input)->combinate;

my $json = $compiler->to_json;

# XXX Hack to use Perl Pegex compile with JS.
# We should be using JS Pegex compiler.
$json =~ s/\\z/\$/g;

print $json;
